<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Temperature â€“ Terahertz-metallization of NdNiO&lt;sub&gt;3&lt;/sub&gt;</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../linear_spectroscopy/sample_comparisons.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../linear_spectroscopy/temperature.html">Linear spectroscopy</a></li><li class="breadcrumb-item"><a href="../linear_spectroscopy/temperature.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Temperature</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Terahertz-metallization of NdNiO<sub>3</sub></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear spectroscopy</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear_spectroscopy/temperature.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Temperature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear_spectroscopy/sample_comparisons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sample comparisons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear_spectroscopy/substrate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Substrate</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dynamics/overlap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Pump-probe overlap</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dynamics/decay.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Decay dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Electric field susceptibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../field_dependence/susceptibility_temperature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Temperature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../field_dependence/susceptibility_long.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nanosecond dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../field_dependence/susceptibility_evolution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Detailed look at three timescales</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Photodoping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../photodoping/photodoping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Photodoping a film</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Nonlinear spectroscopy</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nonlinear_spectroscopy/three_temperatures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparing low and moderate temperature</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Cavity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calculations/field_enhancement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Field enhancement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cavity/polarization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Cavity polarization</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#film" id="toc-film" class="nav-link active" data-scroll-target="#film"><span class="header-section-number">1.1</span> Film</a></li>
  <li><a href="#metasurface" id="toc-metasurface" class="nav-link" data-scroll-target="#metasurface"><span class="header-section-number">1.2</span> Metasurface</a></li>
  <li><a href="#calculations" id="toc-calculations" class="nav-link" data-scroll-target="#calculations"><span class="header-section-number">1.3</span> Calculations</a></li>
  <li><a href="#metasurface-with-finite-scattering-time" id="toc-metasurface-with-finite-scattering-time" class="nav-link" data-scroll-target="#metasurface-with-finite-scattering-time"><span class="header-section-number">1.4</span> Metasurface with finite scattering time</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../linear_spectroscopy/temperature.html">Linear spectroscopy</a></li><li class="breadcrumb-item"><a href="../linear_spectroscopy/temperature.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Temperature</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Temperature</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="film" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="film"><span class="header-section-number">1.1</span> Film</h2>
<p>Let us start by considering the spectroscopy of a thin film, without the deposition of a gold metasurface. The average transmission amplitude is shown in <a href="#fig-film-temperature-dependence" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>. The corresponding real conductivity is estimated from the transmission magnitude <span class="math inline">\(|t|\)</span>,</p>
<p><span class="math display">\[
    \sigma = \frac{1 + n_s}{Z_0 d}\frac{1-|t|}{|t|}
\]</span></p>
<p>with film thickness <span class="math inline">\(d = 10.8\,\mathrm{nm}\)</span>, and refractive index <span class="math inline">\(n_s = 4.8\)</span> of the substrate. The conductivity is shown on the secondary axis in <a href="#fig-film-temperature-dependence" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>.</p>
<div id="cell-fig-film-temperature-dependence" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-film-temperature-dependence" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-film-temperature-dependence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-film-temperature-dependence-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1.1: The temperature dependence of the average transmission amplitude of the film, for both heating directions."><img src="temperature_files/figure-html/fig-film-temperature-dependence-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-film-temperature-dependence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: The temperature dependence of the average transmission amplitude of the film, for both heating directions.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="metasurface" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="metasurface"><span class="header-section-number">1.2</span> Metasurface</h2>
<p>After depositing a gold metasurface on the film, the transmission amplitude is shown in <a href="#fig-metasurface-spectra" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>. This amplitude is defined as the ratio of the spectrum of a waveform transmitted through the sample <span class="math inline">\(\hat{S}_{\mathrm{sam}}(T)\)</span> to the spectrum of a waveform transmitted through a reference substrate <span class="math inline">\(\hat{S}_{\mathrm{sub}}(T)\)</span>,</p>
<p><span id="eq-transmission-amplitude-meas"><span class="math display">\[
    \hat{t} = \frac{\hat{S}_{\mathrm{sam}}(T)}{\hat{S}_{\mathrm{sub}}(T)}
\tag{1.1}\]</span></span></p>
<p>In panel <strong>b</strong> of Figure <a href="#fig-metasurface-spectra" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> is shown the amplitude at 1 THz as a function of temperature for the two temperature sweep directions. Notice that no hysteresis is present.</p>
<div id="cell-fig-metasurface-spectra" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div id="fig-metasurface-spectra" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-metasurface-spectra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-metasurface-spectra-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;1.2: The transmission amplitude spectra for a set of temperatures, for both heating directions (cooling, -1, and heating, +1)."><img src="temperature_files/figure-html/fig-metasurface-spectra-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-metasurface-spectra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: The transmission amplitude spectra for a set of temperatures, for both heating directions (cooling, -1, and heating, +1).
</figcaption>
</figure>
</div>
</div>
</div>
<p>We know from transport measurements that the sample exhibits a clear metal-to-insulator transition around 170 K. This transition temperature is not easily identifiable from <a href="#fig-metasurface-spectra" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> <strong>b</strong>, but will become clear when we convert the transmission amplitude to conductivity.</p>
</section>
<section id="calculations" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="calculations"><span class="header-section-number">1.3</span> Calculations</h2>
<p>The transmission amplitude of the sample was calculated theoretically, assuming a homogeneous conductivity across the sample. A subset of the calculated transmission amplitude spectra is shown in <a href="#fig-spectra-calc" class="quarto-xref">Figure&nbsp;<span>1.3</span></a>.</p>
<div id="4e8d5819" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>

<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">cond_gap</th>
<th data-quarto-table-cell-role="th">cond_film</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">t.real</th>
<th data-quarto-table-cell-role="th">t.imag</th>
</tr>
<tr class="odd">
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>100.0</td>
<td>146.0</td>
<td>0.2</td>
<td>0.9939092</td>
<td>-0.062831</td>
</tr>
<tr class="even">
<td>100.0</td>
<td>146.0</td>
<td>0.256</td>
<td>0.991093</td>
<td>-0.081497</td>
</tr>
<tr class="odd">
<td>100.0</td>
<td>146.0</td>
<td>0.311</td>
<td>0.987555</td>
<td>-0.100842</td>
</tr>
<tr class="even">
<td>100.0</td>
<td>146.0</td>
<td>0.366</td>
<td>0.983047</td>
<td>-0.120582</td>
</tr>
<tr class="odd">
<td>100.0</td>
<td>146.0</td>
<td>0.42</td>
<td>0.977913</td>
<td>-0.140637</td>
</tr>
<tr class="even">
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr class="odd">
<td>912000.0</td>
<td>1e6</td>
<td>2.063</td>
<td>0.385546</td>
<td>0.0882</td>
</tr>
<tr class="even">
<td>912000.0</td>
<td>1e6</td>
<td>2.095</td>
<td>0.38966</td>
<td>0.085757</td>
</tr>
<tr class="odd">
<td>912000.0</td>
<td>1e6</td>
<td>2.129</td>
<td>0.393373</td>
<td>0.084034</td>
</tr>
<tr class="even">
<td>912000.0</td>
<td>1e6</td>
<td>2.165</td>
<td>0.3971802</td>
<td>0.082684</td>
</tr>
<tr class="odd">
<td>912000.0</td>
<td>1e6</td>
<td>2.203</td>
<td>0.4008718</td>
<td>0.081284</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-fig-spectra-calc" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div id="fig-spectra-calc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spectra-calc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-spectra-calc-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;1.3: A subset of the calculated transmission amplitude spectra, for a set of conductivities."><img src="temperature_files/figure-html/fig-spectra-calc-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spectra-calc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: A subset of the calculated transmission amplitude spectra, for a set of conductivities.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We want to extract the conductivity <span class="math inline">\(\sigma\)</span> from the calculations, at each experimental temperature <span class="math inline">\(T\)</span>. To enhance the match between calculation an experiment, it is helpful to consider the <em>relative transmission amplitude</em> rather than the absolute:</p>
<p><span id="eq-relative-transmission-meas"><span class="math display">\[
    \hat{t}_r(T) \equiv \frac{\Delta\hat{t}}{\hat{t}_0} = \frac{\hat{S}(T) - \hat{S}_0}{\hat{S}_0}
\tag{1.2}\]</span></span></p>
<p>This removes any hidden response functions from the experiment that were not successfully deconvolved from the signal. We choose <span class="math inline">\(\hat{S}_0 = \hat{S}(T_{\mathrm{min}})\)</span> with <span class="math inline">\(T_{\mathrm{min}}\)</span> being the base temperature of the optical cryostat of about 10 kelvin.</p>
<p>Similarly, for the calculation, the relative transmission amplitude is</p>
<p><span id="eq-relative-transmission-calc"><span class="math display">\[
    \hat{t}_r(\sigma, \sigma_0) \equiv \frac{\Delta\hat{t}}{\hat{t}_0} = \frac{\hat{S}(\sigma) - \hat{S}(\sigma_0)}{\hat{S}(\sigma_0)}
\tag{1.3}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_0\)</span> is the conductivity of the sample at the base temperature <span class="math inline">\(T_{\mathrm{min}}\)</span>, which is not known <em>a priori</em>. By moving to this relative representation, we add one extra unknown to our problem, namely the value of <span class="math inline">\(\sigma_0 = \sigma(|t|)\)</span>, which is a shared parameter for all temperatures <span class="math inline">\(T\)</span>.</p>
<div id="cell-fig-data" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div id="fig-data" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-data-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;1.4: To the left, the experimental relative spectra; to the right, the calculated relative spectra, for a fixed choice of \sigma_0."><img src="temperature_files/figure-html/fig-data-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: To the left, the experimental relative spectra; to the right, the calculated relative spectra, for a fixed choice of <span class="math inline">\(\sigma_0\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We seek to find <span class="math inline">\(\sigma_0\)</span> and <span class="math inline">\(\{\sigma\}_T\)</span> that solves</p>
<p><span id="eq-minimize"><span class="math display">\[
    \min_{\sigma_0} \frac{1}{N}\sum_{i=1}^N  \min_\sigma \,\lVert \hat{t}_{r, \mathrm{meas}}(T_i) - \hat{t}_{r, \mathrm{calc}}(\sigma,\sigma_0)
\tag{1.4}\]</span></span></p>
<p>where <span class="math inline">\(\lVert\cdot\rVert\)</span> is the norm over the frequency domain. The calculations of the relative transmission amplitude are performed on a dense grid of <span class="math inline">\(\sigma\)</span>, and cubic interpolation is used to estimate the relative transmission amplitude at arbitrary conductivities.</p>
<p>To find the optimal reference conductivity (<span class="math inline">\(\sigma_0\)</span>), we perform the inner minimization for each candidate <span class="math inline">\(\sigma_0\)</span> to obtain the optimal set <span class="math inline">\(\{\sigma\}_T\)</span>, in the sense of minimizing the residual sum of squares. This gives us an outer error measure <span class="math inline">\(\varepsilon_{\sigma_0}\)</span> for each candidate <span class="math inline">\(\sigma_0\)</span>,</p>
<p><span id="eq-outer-error"><span class="math display">\[
    \varepsilon(\sigma_0) = \frac{1}{N}\sum_{i=1}^N  \min_\sigma \,\lVert \hat{t}_{r, \mathrm{meas}}(T_i) - \hat{t}_{r, \mathrm{calc}}(\sigma,\sigma_0)\rVert
\tag{1.5}\]</span></span></p>
<p>which we plot in <a href="#fig-error-cond0" class="quarto-xref">Figure&nbsp;<span>1.5</span></a>.</p>
<div id="cell-fig-error-cond0" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div id="fig-error-cond0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-error-cond0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-error-cond0-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;1.5: The aggregate error as defined in Equation&nbsp;eq-outer-error, as a function of the reference conductivity \sigma_0."><img src="temperature_files/figure-html/fig-error-cond0-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-error-cond0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: The aggregate error as defined in <a href="#eq-outer-error" class="quarto-xref">Equation&nbsp;<span>1.5</span></a>, as a function of the reference conductivity <span class="math inline">\(\sigma_0\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Fortunately this has a global minimum, and we have a good estimate for the reference conductivity <span class="math inline">\(\sigma_0\)</span>. Fixing this <span class="math inline">\(\sigma_0\)</span>, we can go back and explore the error landscape in the space of <span class="math inline">\(\sigma\)</span>,</p>
<p><span id="eq-error-element"><span class="math display">\[
    \varepsilon(\sigma, T) = \,\lVert \hat{t}_{r, \mathrm{meas}}(T) - \hat{t}_{r, \mathrm{calc}}(\sigma)\rVert_2
\tag{1.6}\]</span></span></p>
<div id="cell-fig-error-cond" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div id="fig-error-cond" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-error-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-error-cond-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;1.6: The aggregate error as defined in Equation&nbsp;eq-outer-error, as a function of the reference conductivity \sigma."><img src="temperature_files/figure-html/fig-error-cond-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-error-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: The aggregate error as defined in <a href="#eq-outer-error" class="quarto-xref">Equation&nbsp;<span>1.5</span></a>, as a function of the reference conductivity <span class="math inline">\(\sigma\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The error is larger at higher temperatures, since that is where the relative transmission amplitude is also the largest. But there is at least one minimum for each temperature, and we get good estimates for the conductivity at each temperature. There is a local minimum around <span class="math inline">\(\sigma = 3\times10^3\)</span> which is temperature independent, and therefore not physical. We therefore restrict the minima to <span class="math inline">\(\sigma &gt; 3\times10^3\)</span>, and obtain unique solutions.</p>
<p>We inspect the <span class="math inline">\(\hat{t}_r\)</span> experimental and calculated distributions, and the corresponding residuals, in <a href="#fig-data" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>.</p>
<div id="cell-fig-solution" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div id="fig-solution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-solution-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;1.7: Solution to Equation&nbsp;eq-minimize. To the left, the experimental relative spectra; in the middle the calculated relative spectra, and to the right the residuals."><img src="temperature_files/figure-html/fig-solution-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.7: Solution to <a href="#eq-minimize" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>. To the left, the experimental relative spectra; in the middle the calculated relative spectra, and to the right the residuals.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The residuals are small, and the match between calculation and experiment is acceptable, aside from a systematic error related to an overall slope. The final mapping from temperature to conductivity is shown in <a href="../dynamics/overlap.html#fig-mapping" class="quarto-xref">Figure&nbsp;<span>4.3</span></a>.</p>
<div id="cell-fig-mapping" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div id="fig-mapping" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mapping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-mapping-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;1.8: The mapping that solves Equation&nbsp;eq-minimize."><img src="temperature_files/figure-html/fig-mapping-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mapping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.8: The mapping that solves <a href="#eq-minimize" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="metasurface-with-finite-scattering-time" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="metasurface-with-finite-scattering-time"><span class="header-section-number">1.4</span> Metasurface with finite scattering time</h2>
<p>The above analysis uses a constant, and real, conductivity <span class="math inline">\(\sigma\)</span> for the film. In reality, the conductivity is frequency dependent,</p>
<p><span class="math display">\[
    \sigma(\omega) = \frac{\sigma_\text{dc}}{1 - i\omega\tau}
\]</span></p>
<p>where <span class="math inline">\(\sigma_\text{dc}\)</span> is the DC conductivity, and <span class="math inline">\(\tau\)</span> is an electronic scattering time. Again, using the relative transmission amplitude requires us to find the reference values <span class="math inline">\(\sigma_0\)</span> and <span class="math inline">\(\tau_0\)</span> that minimizes the outer error as defined in <a href="#eq-outer-error" class="quarto-xref">Equation&nbsp;<span>1.5</span></a>. A colormap of this error is shown in <a href="#fig-error-cond0-lossy" class="quarto-xref">Figure&nbsp;<span>1.9</span></a>.</p>
<div id="cell-fig-error-cond0-lossy" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div id="fig-error-cond0-lossy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-error-cond0-lossy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-error-cond0-lossy-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;1.9: Color map of the logarithm of the aggregate error as defined in Equation&nbsp;eq-outer-error, as a function of the reference conductivity \sigma_0 and scattering time \tau_0. A clear minimum is present at \tau_0 \approx 60\,\text{fs} and \sigma_0 = 7e4\,\text{S/m}. This is used as the reference parameters for the subsequent analysis, and the scattering time \tau_0 is assumed equal at all temperatures."><img src="temperature_files/figure-html/fig-error-cond0-lossy-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-error-cond0-lossy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.9: Color map of the logarithm of the aggregate error as defined in <a href="#eq-outer-error" class="quarto-xref">Equation&nbsp;<span>1.5</span></a>, as a function of the reference conductivity <span class="math inline">\(\sigma_0\)</span> and scattering time <span class="math inline">\(\tau_0\)</span>. A clear minimum is present at <span class="math inline">\(\tau_0 \approx 60\,\text{fs}\)</span> and <span class="math inline">\(\sigma_0 = 7e4\,\text{S/m}\)</span>. This is used as the reference parameters for the subsequent analysis, and the scattering time <span class="math inline">\(\tau_0\)</span> is assumed equal at all temperatures.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Having identified a minimum for the reference parameters, we proceed to fix <span class="math inline">\(\tau = \tau_0\)</span> across all temperatures, and select the minimizing values for <span class="math inline">\(\sigma\)</span> at each temperature. The resulting mapping is shown in <a href="#fig-mapping-lossy" class="quarto-xref">Figure&nbsp;<span>1.10</span></a>.</p>
<div id="cell-fig-mapping-lossy" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display">
<div id="fig-mapping-lossy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mapping-lossy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-mapping-lossy-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;1.10: The mapping that solves Equation&nbsp;eq-minimize."><img src="temperature_files/figure-html/fig-mapping-lossy-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mapping-lossy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.10: The mapping that solves <a href="#eq-minimize" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-mapping-lossy-linear" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div id="fig-mapping-lossy-linear" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mapping-lossy-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-mapping-lossy-linear-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;1.11: The mapping that solves Equation&nbsp;eq-minimize."><img src="temperature_files/figure-html/fig-mapping-lossy-linear-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mapping-lossy-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.11: The mapping that solves <a href="#eq-minimize" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-film-metasurface" class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<div id="fig-film-metasurface" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-film-metasurface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-film-metasurface-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;1.12: The temperature dependence of the average transmission amplitude of the film, for both heating directions."><img src="temperature_files/figure-html/fig-film-metasurface-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-film-metasurface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.12: The temperature dependence of the average transmission amplitude of the film, for both heating directions.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Overall, we find that including this finite scattering time slightly improves the match between calculation and experiment (i.e.&nbsp;a slightly smaller residual), particularly in the imaginary part of the transmission amplitude.</p>
<div id="cell-fig-metasurface-film" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div id="fig-metasurface-film" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-metasurface-film-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="temperature_files/figure-html/fig-metasurface-film-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;1.13: Comparison of film (left) and metasurface (right)."><img src="temperature_files/figure-html/fig-metasurface-film-output-1.svg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-metasurface-film-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.13: Comparison of film (left) and metasurface (right).
</figcaption>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../linear_spectroscopy/sample_comparisons.html" class="pagination-link" aria-label="Sample comparisons">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sample comparisons</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","closeEffect":"zoom","loop":false,"descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>